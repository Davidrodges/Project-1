<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Davina and Rodgers Solutions - Chicken Layers Farm Management System</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f8f9fa; margin: 0; padding: 0; }
        header { background: #4caf50; color: white; padding: 1rem; text-align: center; }
        main { max-width: 900px; margin: 2rem auto; background: white; border-radius: 8px; box-shadow: 0 2px 8px #ccc; padding: 2rem; }
        section { margin-bottom: 2rem; }
        h2 { color: #388e3c; }
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        label { display: block; margin-top: 0.5rem; }
        input, select, textarea { width: 100%; padding: 0.5rem; margin-top: 0.2rem; }
        button { background: #388e3c; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; margin-top: 1rem; cursor: pointer; }
        button:hover { background: #2e7031; }
        table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        th, td { border: 1px solid #ddd; padding: 0.5rem; text-align: left; }
        th { background: #e8f5e9; }
    </style>
</head>
<body>
    <header>
        <h1>Davina and Rodgers Solutions</h1>
        <p>Chicken Layers Farm Management Dashboard</p>
    </header>
    <main>
        <section id="summary">
            <h2>Farm Summary</h2>
            <div id="summary-stats">
                <strong>Total Expenses:</strong> <span id="summary-expenses">0.00</span> Ksh &nbsp;|
                <strong>Total Sales:</strong> <span id="summary-sales">0.00</span> Ksh &nbsp;|
                <strong>Profit:</strong> <span id="summary-profit">0.00</span> Ksh &nbsp;|
                <strong>Total Eggs:</strong> <span id="summary-eggs">0</span> &nbsp;|
                <strong>Total Bird Deaths:</strong> <span id="summary-deaths">0</span>
            </div>
            <button id="clear-data-btn">Clear All Data</button>
            <button id="export-data-btn">Export Data (JSON)</button>
            <label>
                <input type="file" id="import-data-input" accept="application/json" style="display:none;" />
                <button id="import-data-btn" type="button">Import Data (JSON)</button>
            </label>
        </section>
        <div class="dashboard-grid">
            <section id="feeding-water">
                <h2>Feeding & Water Management</h2>
                <form id="feed-form">
                    <label>Feed Type
                        <select id="feed-type" required>
                            <option value="Starter">Starter</option>
                            <option value="Grower">Grower</option>
                            <option value="Layer">Layer</option>
                        </select>
                    </label>
                    <label>Quantity (kg)
                        <input type="number" id="feed-quantity" min="0" step="0.1" required />
                    </label>
                    <label>Schedule
                        <select id="feed-schedule" required>
                            <option value="Morning">Morning</option>
                            <option value="Midday">Midday</option>
                            <option value="Evening">Evening</option>
                        </select>
                    </label>
                    <label>Water Check
                        <select id="water-check" required>
                            <option value="Clean">Clean</option>
                            <option value="Flushed">Flushed</option>
                            <option value="Refilled">Refilled</option>
                        </select>
                    </label>
                    <label>Date
                        <input type="date" id="feed-date" required />
                    </label>
                    <button type="submit">Record Feed & Water</button>
                </form>
                <table id="feed-table">
                    <thead>
                        <tr>
                            <th>Feed Type</th>
                            <th>Quantity (kg)</th>
                            <th>Schedule</th>
                            <th>Water Check</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="health">
                <h2>Health Management</h2>
                <form id="vaccination-form">
                    <label>Type
                        <select id="vaccination-type" required>
                            <option value="Newcastle">Newcastle</option>
                            <option value="Gumboro">Gumboro</option>
                            <option value="Fowl Pox">Fowl Pox</option>
                            <option value="Other">Other</option>
                        </select>
                    </label>
                    <label>Date
                        <input type="date" id="vaccination-date" required />
                    </label>
                    <button type="submit">Record Vaccination</button>
                </form>
                <form id="observation-form">
                    <label>Observation
                        <textarea id="observation-note" placeholder="e.g., Appetite good, no droppings issues" required></textarea>
                    </label>
                    <label>Date
                        <input type="date" id="observation-date" required />
                    </label>
                    <button type="submit">Record Observation</button>
                </form>
                <table id="vaccination-table">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <table id="observation-table">
                    <thead>
                        <tr>
                            <th>Observation</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="egg-production">
                <h2>Egg Production & Grading</h2>
                <form id="egg-form">
                    <label>Number of Eggs Collected
                        <input type="number" id="egg-count" min="0" step="1" required />
                    </label>
                    <label>Grade
                        <select id="egg-grade" required>
                            <option value="Grade A">Grade A</option>
                            <option value="Grade B">Grade B</option>
                            <option value="Grade C">Grade C</option>
                            <option value="Cracked">Cracked</option>
                        </select>
                    </label>
                    <label>Storage Notes
                        <input type="text" id="egg-storage" placeholder="e.g., Clean, dry, ventilated" />
                    </label>
                    <label>Date
                        <input type="date" id="egg-date" required />
                    </label>
                    <button type="submit">Record Collection</button>
                </form>
                <table id="egg-table">
                    <thead>
                        <tr>
                            <th>Eggs Collected</th>
                            <th>Grade</th>
                            <th>Storage Notes</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="layer-cycle">
                <h2>Layer Cycle Management</h2>
                <form id="cycle-form">
                    <label>Flock Stage
                        <select id="flock-stage" required>
                            <option value="Pullets (0-18 weeks)">Pullets (0-18 weeks)</option>
                            <option value="Point-of-Lay (18-20 weeks)">Point-of-Lay (18-20 weeks)</option>
                            <option value="Peak Production (20-40 weeks)">Peak Production (20-40 weeks)</option>
                            <option value="Decline (after 72 weeks)">Decline (after 72 weeks)</option>
                        </select>
                    </label>
                    <label>Age (weeks)
                        <input type="number" id="flock-age" min="0" step="1" required />
                    </label>
                    <label>Recommendations
                        <textarea id="cycle-recommendations" placeholder="e.g., Increase light, layer feed" required></textarea>
                    </label>
                    <label>Date
                        <input type="date" id="cycle-date" required />
                    </label>
                    <button type="submit">Record Cycle Update</button>
                </form>
                <table id="cycle-table">
                    <thead>
                        <tr>
                            <th>Stage</th>
                            <th>Age (weeks)</th>
                            <th>Recommendations</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="staff-routine">
                <h2>Farm Staff & Daily Routine</h2>
                <form id="routine-form">
                    <label>Task
                        <select id="routine-task" required>
                            <option value="Feed & Water">Feed & Water</option>
                            <option value="Egg Collection">Egg Collection</option>
                            <option value="Health Check">Health Check</option>
                            <option value="Cleaning">Cleaning</option>
                            <option value="Ventilation Check">Ventilation Check</option>
                            <option value="Other">Other</option>
                        </select>
                    </label>
                    <label>Assigned To
                        <input type="text" id="routine-assigned" placeholder="Employee name" required />
                    </label>
                    <label>Status
                        <select id="routine-status" required>
                            <option value="Completed">Completed</option>
                            <option value="Pending">Pending</option>
                        </select>
                    </label>
                    <label>Date
                        <input type="date" id="routine-date" required />
                    </label>
                    <button type="submit">Record Routine</button>
                </form>
                <table id="routine-table">
                    <thead>
                        <tr>
                            <th>Task</th>
                            <th>Assigned To</th>
                            <th>Status</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="financial-market">
                <h2>Financial & Market Management</h2>
                <form id="channel-form">
                    <label>Sales Channel
                        <select id="sales-channel" required>
                            <option value="Supermarkets">Supermarkets</option>
                            <option value="Retailers">Retailers</option>
                            <option value="Schools">Schools</option>
                            <option value="Direct Consumers">Direct Consumers</option>
                            <option value="Other">Other</option>
                        </select>
                    </label>
                    <label>Trays Sold
                        <input type="number" id="channel-trays" min="1" step="1" required />
                    </label>
                    <label>Price per Tray (Ksh)
                        <input type="number" id="channel-price" min="0" step="0.01" value="430" required />
                    </label>
                    <label>Date
                        <input type="date" id="channel-date" required />
                    </label>
                    <button type="submit">Record Channel Sale</button>
                </form>
                <table id="channel-table">
                    <thead>
                        <tr>
                            <th>Channel</th>
                            <th>Trays</th>
                            <th>Price per Tray</th>
                            <th>Total (Ksh)</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="expenses">
                <h2>Expenses</h2>
                <form id="expense-form">
                    <label>Type
                        <select id="expense-type" required>
                            <option value="Feed">Feed</option>
                            <option value="Medicine">Medicine</option>
                            <option value="Utilities">Utilities</option>
                            <option value="Salaries">Salaries</option>
                            <option value="Other">Other</option>
                        </select>
                    </label>
                    <label>Amount (Ksh)
                        <input type="number" id="expense-amount" min="0" step="0.01" required />
                    </label>
                    <label>Date
                        <input type="date" id="expense-date" required />
                    </label>
                    <button type="submit">Add Expense</button>
                </form>
                <table id="expense-table">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Amount (Ksh)</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="sales">
                <h2>Sales</h2>
                <div style="margin-bottom: 0.5rem; color: #333;">
                    <strong>Price per tray of eggs: 430 Ksh</strong>
                </div>
                <form id="sales-form">
                    <label>Number of Trays
                        <input type="number" id="tray-count" min="1" step="1" required />
                    </label>
                    <label>Date
                        <input type="date" id="sales-date" required />
                    </label>
                    <div style="margin: 0.5rem 0;">
                        <strong>Total Sale (Ksh):</strong> <span id="calculated-sale">0.00</span>
                    </div>
                    <button type="submit">Add Sale</button>
                </form>
                <table id="sales-table">
                    <thead>
                        <tr>
                            <th>Trays</th>
                            <th>Amount (Ksh)</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="deaths">
                <h2>Bird Mortality</h2>
                <form id="death-form">
                    <label>Number of Deaths
                        <input type="number" id="death-count" min="1" step="1" required />
                    </label>
                    <label>Date
                        <input type="date" id="death-date" required />
                    </label>
                    <button type="submit">Record Death</button>
                </form>
                <table id="death-table">
                    <thead>
                        <tr>
                            <th>Number of Deaths</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
            <section id="profit">
                <h2>Profit Calculation</h2>
                <div style="margin-top:1rem;">
                    <strong>Total Sales:</strong> <span id="total-sales">0.00</span> Ksh<br>
                    <strong>Total Expenses:</strong> <span id="total-expenses">0.00</span> Ksh<br>
                    <strong>Profit:</strong> <span id="profit">0.00</span> Ksh<br>
                    <strong>Weekly Profit:</strong> <span id="profit-week">0.00</span> Ksh<br>
                    <strong>Monthly Profit:</strong> <span id="profit-month">0.00</span> Ksh
                </div>
            </section>
        </div>
    </main>
    <script>
        // Data arrays
        let expenses = [];
        let sales = [];
        let feedSchedules = [];
        let vaccinations = [];
        let observations = [];
        let eggs = [];
        let layerCycles = [];
        let routines = [];
        let salesChannels = [];
        let deaths = [];

        // Data persistence
        function saveData() {
            localStorage.setItem('expenses', JSON.stringify(expenses));
            localStorage.setItem('sales', JSON.stringify(sales));
            localStorage.setItem('feedSchedules', JSON.stringify(feedSchedules));
            localStorage.setItem('vaccinations', JSON.stringify(vaccinations));
            localStorage.setItem('observations', JSON.stringify(observations));
            localStorage.setItem('eggs', JSON.stringify(eggs));
            localStorage.setItem('layerCycles', JSON.stringify(layerCycles));
            localStorage.setItem('routines', JSON.stringify(routines));
            localStorage.setItem('salesChannels', JSON.stringify(salesChannels));
            localStorage.setItem('deaths', JSON.stringify(deaths));
        }

        function loadData() {
            expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
            sales = JSON.parse(localStorage.getItem('sales') || '[]');
            feedSchedules = JSON.parse(localStorage.getItem('feedSchedules') || '[]');
            vaccinations = JSON.parse(localStorage.getItem('vaccinations') || '[]');
            observations = JSON.parse(localStorage.getItem('observations') || '[]');
            eggs = JSON.parse(localStorage.getItem('eggs') || '[]');
            layerCycles = JSON.parse(localStorage.getItem('layerCycles') || '[]');
            routines = JSON.parse(localStorage.getItem('routines') || '[]');
            salesChannels = JSON.parse(localStorage.getItem('salesChannels') || '[]');
            deaths = JSON.parse(localStorage.getItem('deaths') || '[]');
        }

        // Clear all data
        document.getElementById('clear-data-btn').onclick = function() {
            if (confirm('Are you sure you want to clear all data?')) {
                localStorage.clear();
                expenses = [];
                sales = [];
                feedSchedules = [];
                vaccinations = [];
                observations = [];
                eggs = [];
                layerCycles = [];
                routines = [];
                salesChannels = [];
                deaths = [];
                renderAll();
            }
        };

        // Export data
        document.getElementById('export-data-btn').onclick = function() {
            const allData = {
                expenses, sales, feedSchedules, vaccinations, observations, eggs, layerCycles, routines, salesChannels, deaths
            };
            const blob = new Blob([JSON.stringify(allData, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'farm_data_backup.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        };

        // Import data
        document.getElementById('import-data-btn').onclick = function() {
            document.getElementById('import-data-input').click();
        };

        document.getElementById('import-data-input').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(evt) {
                try {
                    const data = JSON.parse(evt.target.result);
                    expenses = data.expenses || [];
                    sales = data.sales || [];
                    feedSchedules = data.feedSchedules || [];
                    vaccinations = data.vaccinations || [];
                    observations = data.observations || [];
                    eggs = data.eggs || [];
                    layerCycles = data.layerCycles || [];
                    routines = data.routines || [];
                    salesChannels = data.salesChannels || [];
                    deaths = data.deaths || [];
                    saveData();
                    renderAll();
                    alert('Data imported successfully!');
                } catch (err) {
                    alert('Failed to import data.');
                }
            };
            reader.readAsText(file);
        });

        // Form handlers
        document.getElementById('feed-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const type = document.getElementById('feed-type').value;
            const quantity = parseFloat(document.getElementById('feed-quantity').value);
            const schedule = document.getElementById('feed-schedule').value;
            const waterCheck = document.getElementById('water-check').value;
            const date = document.getElementById('feed-date').value;
            if (!type || !quantity || !schedule || !waterCheck || !date) return;
            feedSchedules.push({ type, quantity, schedule, waterCheck, date });
            saveData();
            renderFeedSchedules();
            this.reset();
        });

        document.getElementById('vaccination-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const type = document.getElementById('vaccination-type').value;
            const date = document.getElementById('vaccination-date').value;
            if (!type || !date) return;
            vaccinations.push({ type, date });
            saveData();
            renderVaccinations();
            this.reset();
        });

        document.getElementById('observation-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const note = document.getElementById('observation-note').value;
            const date = document.getElementById('observation-date').value;
            if (!note || !date) return;
            observations.push({ note, date });
            saveData();
            renderObservations();
            this.reset();
        });

        document.getElementById('egg-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const count = parseInt(document.getElementById('egg-count').value);
            const grade = document.getElementById('egg-grade').value;
            const storage = document.getElementById('egg-storage').value;
            const date = document.getElementById('egg-date').value;
            if (!date) return;
            eggs.push({ count, grade, storage, date });
            saveData();
            renderEggs();
            renderSummary();
            this.reset();
        });

        document.getElementById('cycle-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const stage = document.getElementById('flock-stage').value;
            const age = parseInt(document.getElementById('flock-age').value);
            const recommendations = document.getElementById('cycle-recommendations').value;
            const date = document.getElementById('cycle-date').value;
            if (!stage || !age || !recommendations || !date) return;
            layerCycles.push({ stage, age, recommendations, date });
            saveData();
            renderLayerCycles();
            this.reset();
        });

        document.getElementById('routine-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const task = document.getElementById('routine-task').value;
            const assigned = document.getElementById('routine-assigned').value;
            const status = document.getElementById('routine-status').value;
            const date = document.getElementById('routine-date').value;
            if (!task || !assigned || !status || !date) return;
            routines.push({ task, assigned, status, date });
            saveData();
            renderRoutines();
            this.reset();
        });

        document.getElementById('channel-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const channel = document.getElementById('sales-channel').value;
            const trays = parseInt(document.getElementById('channel-trays').value);
            const price = parseFloat(document.getElementById('channel-price').value);
            const total = trays * price;
            const date = document.getElementById('channel-date').value;
            if (!channel || !trays || !price || !date) return;
            salesChannels.push({ channel, trays, price, total, date });
            saveData();
            renderSalesChannels();
            this.reset();
        });

        document.getElementById('expense-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const type = document.getElementById('expense-type').value;
            const amount = parseFloat(document.getElementById('expense-amount').value);
            const date = document.getElementById('expense-date').value;
            if (!type || !amount || !date) return;
            expenses.push({ type, amount, date });
            saveData();
            renderExpenses();
            renderProfit();
            renderSummary();
            this.reset();
        });

        document.getElementById('sales-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const trays = parseInt(document.getElementById('tray-count').value);
            const amount = trays * 430;
            const date = document.getElementById('sales-date').value;
            if (!trays || !date) return;
            sales.push({ trays, amount, date });
            saveData();
            renderSales();
            renderProfit();
            renderSummary();
            this.reset();
            document.getElementById('calculated-sale').textContent = '0.00';
        });

        document.getElementById('death-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const count = parseInt(document.getElementById('death-count').value);
            const date = document.getElementById('death-date').value;
            if (!count || !date) return;
            deaths.push({ count, date });
            saveData();
            renderDeaths();
            renderSummary();
            this.reset();
        });

        // Update calculated sale
        document.getElementById('tray-count').addEventListener('input', function() {
            const trays = parseInt(this.value) || 0;
            document.getElementById('calculated-sale').textContent = (trays * 430).toFixed(2);
        });

        // Render functions
        function renderFeedSchedules() {
            const tbody = document.querySelector('#feed-table tbody');
            tbody.innerHTML = '';
            feedSchedules.forEach(f => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${f.type}</td><td>${f.quantity}</td><td>${f.schedule}</td><td>${f.waterCheck}</td><td>${f.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderVaccinations() {
            const tbody = document.querySelector('#vaccination-table tbody');
            tbody.innerHTML = '';
            vaccinations.forEach(v => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${v.type}</td><td>${v.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderObservations() {
            const tbody = document.querySelector('#observation-table tbody');
            tbody.innerHTML = '';
            observations.forEach(o => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${o.note}</td><td>${o.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderEggs() {
            const tbody = document.querySelector('#egg-table tbody');
            tbody.innerHTML = '';
            eggs.forEach(e => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${e.count}</td><td>${e.grade || ''}</td><td>${e.storage || ''}</td><td>${e.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderLayerCycles() {
            const tbody = document.querySelector('#cycle-table tbody');
            tbody.innerHTML = '';
            layerCycles.forEach(c => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${c.stage}</td><td>${c.age}</td><td>${c.recommendations}</td><td>${c.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderRoutines() {
            const tbody = document.querySelector('#routine-table tbody');
            tbody.innerHTML = '';
            routines.forEach(r => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${r.task}</td><td>${r.assigned}</td><td>${r.status}</td><td>${r.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderSalesChannels() {
            const tbody = document.querySelector('#channel-table tbody');
            tbody.innerHTML = '';
            salesChannels.forEach(s => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${s.channel}</td><td>${s.trays}</td><td>${s.price.toFixed(2)}</td><td>${s.total.toFixed(2)}</td><td>${s.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderExpenses() {
            const tbody = document.querySelector('#expense-table tbody');
            tbody.innerHTML = '';
            expenses.forEach(exp => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${exp.type}</td><td>${exp.amount.toFixed(2)}</td><td>${exp.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderSales() {
            const tbody = document.querySelector('#sales-table tbody');
            tbody.innerHTML = '';
            sales.forEach(sale => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${sale.trays || ''}</td><td>${sale.amount.toFixed(2)}</td><td>${sale.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderDeaths() {
            const tbody = document.querySelector('#death-table tbody');
            tbody.innerHTML = '';
            deaths.forEach(d => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${d.count}</td><td>${d.date}</td>`;
                tbody.appendChild(row);
            });
        }

        function renderProfit() {
            const totalSales = sales.reduce((sum, s) => sum + s.amount, 0);
            const totalExpenses = expenses.reduce((sum, e) => sum + e.amount, 0);
            const profit = totalSales - totalExpenses;
            document.getElementById('total-sales').textContent = totalSales.toFixed(2);
            document.getElementById('total-expenses').textContent = totalExpenses.toFixed(2);
            document.getElementById('profit').textContent = profit.toFixed(2);

            // Calculate weekly and monthly profit
            const now = new Date();
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay() + 1);
            startOfWeek.setHours(0,0,0,0);
            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);

            const weekSales = sales.filter(s => new Date(s.date) >= startOfWeek).reduce((sum, s) => sum + s.amount, 0);
            const weekExpenses = expenses.filter(e => new Date(e.date) >= startOfWeek).reduce((sum, e) => sum + e.amount, 0);
            const monthSales = sales.filter(s => new Date(s.date) >= startOfMonth).reduce((sum, s) => sum + s.amount, 0);
            const monthExpenses = expenses.filter(e => new Date(e.date) >= startOfMonth).reduce((sum, e) => sum + e.amount, 0);
            const weekProfit = weekSales - weekExpenses;
            const monthProfit = monthSales - monthExpenses;
            document.getElementById('profit-week').textContent = weekProfit.toFixed(2);
            document.getElementById('profit-month').textContent = monthProfit.toFixed(2);
        }

        function renderSummary() {
            document.getElementById('summary-expenses').textContent = expenses.reduce((sum, e) => sum + e.amount, 0).toFixed(2);
            document.getElementById('summary-sales').textContent = sales.reduce((sum, s) => sum + s.amount, 0).toFixed(2);
            document.getElementById('summary-profit').textContent = (sales.reduce((sum, s) => sum + s.amount, 0) - expenses.reduce((sum, e) => sum + e.amount, 0)).toFixed(2);
            document.getElementById('summary-eggs').textContent = eggs.reduce((sum, e) => sum + (e.count || 0), 0);
            document.getElementById('summary-deaths').textContent = deaths.reduce((sum, d) => sum + (d.count || 0), 0);
        }

        function renderAll() {
            renderFeedSchedules();
            renderVaccinations();
            renderObservations();
            renderEggs();
            renderLayerCycles();
            renderRoutines();
            renderSalesChannels();
            renderExpenses();
            renderSales();
            renderDeaths();
            renderProfit();
            renderSummary();
        }

        // Initialize
        loadData();
        renderAll();
    </script>
</body>
</html>
